# CPUの基礎知識

## 1. 命令実行手順
CPUは、プログラムの命令を実行するために以下の手順を繰り返します。

### (1) 命令フェッチ（Instruction Fetch）
- メモリから次の命令を取得し、命令レジスタ（IR）に格納する。
- プログラムカウンタ（PC）は、次の命令アドレスを指すように更新される。

### (2) デコード（Decode）
- 命令レジスタに格納された命令を解読し、必要な操作を決定する。
- オペランド（処理対象のデータ）の取得元や、どの演算器を使用するかを判断する。

### (3) オペランドフェッチ（Operand Fetch）
- 命令の実行に必要なオペランドをメモリやレジスタから取得する。

### (4) 実行（Execute）
- 演算装置（ALU）を使って計算を行う。
- データ転送や条件分岐などの処理を実施する。

### (5) 結果格納（Write Back）
- 実行結果をレジスタやメモリに書き戻す。
- 必要に応じてフラグの更新を行う。

### (6) 次の命令へ
- プログラムカウンタを更新し、次の命令を取得する。

---

## 2. アドレス指定方式
CPUは、メモリ上のデータや命令を取得する際に、アドレス指定方式を利用します。

### (1) 即値アドレス指定（Immediate Addressing）
- 命令自体にオペランド（値）が含まれる。
- 例: `MOV R1, #10`（レジスタR1に10を格納）

### (2) 直接アドレス指定（Direct Addressing）
- 命令内に記載されたアドレスからデータを取得する。
- 例: `MOV R1, [1000H]`（メモリ番地1000Hの値をR1に格納）

### (3) 間接アドレス指定（Indirect Addressing）
- レジスタが指すアドレスのメモリからデータを取得する。
- 例: `MOV R1, [R2]`（レジスタR2が指すメモリ番地のデータをR1に格納）

### (4) インデックスアドレス指定（Indexed Addressing）
- 基本アドレスにオフセットを加えたアドレスからデータを取得する。
- 例: `MOV R1, [R2 + #4]`（R2の値に4を加えたアドレスのデータをR1に格納）

### (5) 相対アドレス指定（Relative Addressing）
- 現在のPC（プログラムカウンタ）にオフセットを加えてアドレスを指定する。
- 例: `JMP +8`（現在のPCに8を加えたアドレスへジャンプ）

---

## 3. CPUの性能評価
CPUの性能は、以下の指標を用いて評価されます。

### (1) クロック周波数（Clock Frequency）
- 単位はHz（ヘルツ）
- 1秒間に何回のクロック信号が発生するかを示す。
- 高いほど処理速度が速い。

### (2) CPI（Cycles Per Instruction）
- 1命令あたりの平均クロックサイクル数。
- 値が小さいほど効率的なCPU。

### (3) MIPS（Million Instructions Per Second）
- 1秒間に実行できる命令数（百万単位）。
- MIPS = （クロック周波数）÷（CPI）

### (4) FLOPS（Floating Point Operations Per Second）
- 1秒間に実行できる浮動小数点演算の回数。
- 科学技術計算やAIの分野で重要。

---

## 4. CPUの性能向上
CPUの性能を向上させるための技術には、以下のようなものがあります。

### (1) パイプライン処理（Pipelining）
- 命令実行を分割し、複数の命令を並列処理。
- 例えば、命令Aのフェッチ中に、命令Bのデコードを行う。

### (2) スーパースカラ（Superscalar）
- 複数の命令を同時に実行できるようにする。
- 例: 2つのALUを使い、2つの命令を並行処理。

### (3) マルチコアプロセッサ（Multi-Core Processor）
- 1つのチップに複数のCPUコアを搭載。
- 複数のプログラムを同時実行可能。

### (4) キャッシュメモリ（Cache Memory）
- よく使うデータを高速なメモリ（キャッシュ）に保存し、アクセス速度を向上。
- L1（CPU内）、L2（CPUチップ内）、L3（マザーボード上）の3段階が一般的。

### (5) 命令並列性（Instruction-Level Parallelism, ILP）
- 命令を同時に処理することで、実行時間を短縮。
- 投機的実行（Speculative Execution）、アウト・オブ・オーダー実行（Out-of-Order Execution）を利用。

### (6) ハイパースレッディング（Hyper-Threading）
- 1つのコアで2つのスレッドを並列実行する技術。
- 仮想的にコアを増やし、CPUのアイドル時間を減らす。

---

## 例題
**Q1. CPUの命令実行手順で「フェッチ」に該当する動作はどれか？**
A) 命令の解読
B) メモリから命令を取り出す
C) 実行結果を格納する
D) 演算を行う

**解答:** B

**Q2. 次のうち、CPUの性能向上技術として「複数の命令を並列実行」するものはどれか？**
A) キャッシュメモリ
B) マルチコアプロセッサ
C) クロック周波数の向上
D) パイプライン処理

**解答:** D

