# CPUの基礎知識

## 1. 命令実行手順
CPUは、プログラムの命令を実行するために以下の手順を繰り返します。

### (1) 命令フェッチ（Instruction Fetch）
- 主記憶装置（メモリ）から命令を取得し、命令レジスタ（IR）に格納する。
- プログラムカウンタ（PC）は、次の命令アドレスを指すように更新される。

### (2) 命令デコード（Instruction Decode）
- 命令レジスタに格納された命令を解読し、必要な操作を決定する。
- オペランド（処理対象のデータ）の取得元や、演算装置（ALU）を利用するかどうかを判断する。

### (3) オペランドフェッチ（Operand Fetch）
- 命令の実行に必要なオペランドを主記憶装置やレジスタから取得する。

### (4) 命令実行（Instruction Execute）
- 演算装置（ALU）を使って計算を行う。
- データ転送や条件分岐などの処理を実施する。

### (5) 結果格納（Write Back）
- 実行結果を汎用レジスタ（GPR: General Purpose Register）または主記憶装置に書き戻す。
- 必要に応じてステータスレジスタ（FR: Flag Register）の更新を行う。

### (6) 次の命令へ
- プログラムカウンタを更新し、次の命令を取得する。

---

## 2. アドレス指定方式
CPUは、主記憶装置上のデータや命令を取得する際に、アドレス指定方式を利用します。

### (1) 即値アドレス指定（Immediate Addressing）
- 命令自体にオペランド（値）が含まれる。
- 例: `MOV R1, #10`（レジスタR1に10を格納）

### (2) 直接アドレス指定（Direct Addressing）
- 命令内に記載されたアドレスからデータを取得する。
- 例: `MOV R1, [1000H]`（メモリ番地1000Hの値をR1に格納）

### (3) 間接アドレス指定（Indirect Addressing）
- レジスタが指すアドレスの主記憶装置からデータを取得する。
- 例: `MOV R1, [R2]`（レジスタR2が指す主記憶の値をR1に格納）

### (4) インデックスアドレス指定（Indexed Addressing）
- 基本アドレスにオフセットを加えたアドレスからデータを取得する。
- 例: `MOV R1, [R2 + #4]`（R2の値に4を加えたアドレスのデータをR1に格納）

### (5) 相対アドレス指定（Relative Addressing）
- 現在のプログラムカウンタ（PC）にオフセットを加えてアドレスを指定する。
- 例: `JMP +8`（現在のPCに8を加えたアドレスへジャンプ）

---

## 3. レジスタの種類
CPUにはさまざまな種類のレジスタが存在し、それぞれ異なる役割を持ちます。

| レジスタ名 | 役割 |
|------------|----------------|
| プログラムカウンタ（PC） | 次に実行する命令のアドレスを保持 |
| 命令レジスタ（IR） | 実行中の命令を格納 |
| インデックスレジスタ | 配列やループ処理時にアドレス計算を行う |
| ベースレジスタ | プログラムのメモリ管理や再配置のための基準アドレスを保持 |
| アキュムレーター | 演算結果の一時的な格納やALUでの計算に使用 |
| 汎用レジスタ（GPR） | 一時的なデータの格納や計算に使用 |

---

## 4. CPUの性能評価
CPUの性能は、以下の指標を用いて評価されます。

### (1) クロック周波数（Clock Frequency）
- 単位はHz（ヘルツ）
- 1秒間に何回のクロック信号が発生するかを示す。
- 高いほど処理速度が速い。

### (2) CPI（Cycles Per Instruction）
- 1命令あたりの平均クロックサイクル数。
- 値が小さいほど効率的なCPU。

### (3) MIPS（Million Instructions Per Second）
- 1秒間に実行できる命令数（百万単位）。
- MIPS = （クロック周波数）÷（CPI）

### (4) FLOPS（Floating Point Operations Per Second）
- 1秒間に実行できる浮動小数点演算の回数。
- 科学技術計算やAIの分野で重要。

---

## 5. CPUの性能向上
CPUの性能を向上させるための技術には、以下のようなものがあります。

### (1) パイプライン処理（Pipelining）
- 命令実行を分割し、複数の命令を並列処理。

### (2) スーパースカラ（Superscalar）
- 複数の命令を同時に実行できるようにする。

### (3) マルチコアプロセッサ（Multi-Core Processor）
- 1つのチップに複数のCPUコアを搭載。

### (4) キャッシュメモリ（Cache Memory）
- よく使うデータを高速なメモリ（キャッシュ）に保存。

### (5) 命令並列性（Instruction-Level Parallelism, ILP）
- 命令を同時に処理することで、実行時間を短縮。

### (6) ハイパースレッディング（Hyper-Threading）
- 1つのコアで2つのスレッドを並列実行する技術。
  
---

## 例題
**Q1. CPUの命令実行手順で「フェッチ」に該当する動作はどれか？**
A) 命令の解読
B) メモリから命令を取り出す
C) 実行結果を格納する
D) 演算を行う

**解答:** B

**Q2. 次のうち、CPUの性能向上技術として「複数の命令を並列実行」するものはどれか？**
A) キャッシュメモリ
B) マルチコアプロセッサ
C) クロック周波数の向上
D) パイプライン処理

**解答:** D

